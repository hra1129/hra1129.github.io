<!DOCTYPE HTML>
<html lang="ja" xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta charset="utf-8">
		<title>HRA's room</title>
		<link href="../../mystyle.css" rel="stylesheet" type="text/css">
	</head>
	<body id="contents_main">
		メガドライブ用ゲームパッドをMSXで利用可能にする改造 (2020年2月1日現在)<br>
		<br>
		[関連情報]<a href="https://github.com/hra1129/msx_tools/tree/main/usb_gamepad_bridge_for_msx">Raspberry Pi Pico を使って USBゲームパッドを JOYMEGA として使えるアダプター</a>も作りました。USBマウスも使えます。制作も簡単です。<br>
		<br>
		<center>
			<h1 id="contents_warning">
				★お約束<br>
				ハードウェアの改造は、ちょっとしたミス一つでそのハードウェアを破壊してしまう恐れを伴います。<br>
				この記事に記載の部品のリビジョンが代わると、この記事の内容がマッチしない可能性もあります。<br>
				マッチしない部品を使用してこの記事を再現した場合に、ハードを破壊する可能性があります。<br>
				そういったリスクを理解した上でご覧ください。<br>
				記載の情報の保証は出来ませんので、記載情報の利用によって、万が一何かしらの不利益・不具合が生じても、当方は一切責任を負いません。<br>
			<h1>
		</center>
		<br>
		メガドライブのコントローラーは、MSXのコントローラーと同じ形状のコネクタになっていますが、微妙に互換性がありません。<br>
		互いにそのまま接続すると故障の恐れがあるので、「試しに接続してみる」のは止めた方が良いです。<br>
		<br>
		ただ、差は微妙なため、ちょっとした修正でメガドラ3BパッドのBボタンとCボタンが、MSXのBボタンとAボタンに対応する形で使えるようになるので、<br>
		そういった改造記事は何カ所かで見かけます。線のつなぎ替えで実現できるのでリーズナブルですが、STARTボタンとAボタンがただの飾りになるという残念さがあります。<br>
		<br>
		MSXのジョイスティックポートには、1本だけ出力専用ポートがあります。これを利用して全ボタン(3Bパッドどころか 6Bパッドも対応しているようです。)を<br>
		MSXから利用可能にしてしまおう、という試みが海外で行われたようで、JoyMega という名前が付けられています。<br>
		すでに対応ソフトもあるようなので、独自に全ボタン有効化するのではなく、この JoyMega を使わせて頂こうということで、3Bパッドの場合を調べてみました。<br>
		<br>
		<a href="./files/JoyMega.pdf">[資料 PDF]</a><br>
		<br>
		MSX の 8pin の出力を反転して、パッドの 7pin へ繋げた状態に変更するだけです。<br>
		パッドの 7pin は、ボタン状態の組 [Bボタン, Cボタン] と [STARTボタン、Aボタン] のどちらを本体側へ伝えるかの選択信号です。<br>
		この反転が無いと、JoyMega非対応のゲームで使える2ボタンが [STARTボタン、Aボタン] になってしまい、使い勝手が悪いから反転が必要になっているようです。<br>
		<br>
		反転は、トランジスタを使って作り込んでも良いし、74HC04 のようなロジックIC を使っても良いです。<br>
		10KΩの抵抗が、手持ちになかったので、74HC04 を使ってみました。<br>
		下写真は、IC の GND を未使用入力ピンに繋げた状態。<br>
		<img src="./image/74hc04.jpg"><br>
		<br>
		下写真は、実際にメガドライブ3Bパッドに組み込んだ状態。むき出しなので、中で動いて変なところでショートしないようにグルーガンで固定しています。<br>
		<img src="./image/joymega_in_megadrive_3b_pad.jpg"><br>
		<br>
		FS-A1GT では問題なく START, A, B, C すべて認識しましたが、OCM では START, A が連打されているような不安定な状態になりました。<br>
		OCM は、+5V出力以外、すべて 3.3V基準になっているので、使ったIC 74HC04P が Hレベルを正常に識別できずに不安定になっているのだと推測しています。<br>
		<br>
		10KΩ抵抗が手に入ったら、トランジスタ版に変更して、OCMでも動作するようにしたいと思います。<br>
		<a href="./body2.html">[次へ]</a><br>
		<br>
	</body>
</html>
